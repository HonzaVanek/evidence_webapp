{% extends "base.html" %}
{% load static %}

{% block title %}Gener√°tor n√°hodn√©ho hesla{% endblock title %}

{% block style %}{% static "pojistenci/generate_password.css" %}{% endblock style %}

{% block content %}
<div class="generate-password-wrapper">
    <h1 class="generate-password-title">Gener√°tor hesel</h1>
    <p class="generate-password-subtitle">Vygenerujte si n√°hodn√© heslo podle sv√Ωch po≈æadavk≈Ø</p>

    {% if error_message %}
        <div class="alert alert-danger" role="alert">
            {{ error_message }}
        </div>
    {% endif %}
    
    <form method="POST" class="generate-password-form">
        {% csrf_token %}
        
        <div class="generate-password-options">
            <div class="mb-3">
                <label for="password_length" class="form-label">D√©lka hesla</label>
                <input type="number" class="form-control" id="password_length" name="password_length" value="16" min="1" max="100">
            </div>

            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="use_uppercase" name="use_uppercase" checked>
                    <label class="form-check-label" for="use_uppercase">Zahrnout velk√° p√≠smena (A-Z)</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="use_lowercase" name="use_lowercase" checked>
                    <label class="form-check-label" for="use_lowercase">Zahrnout mal√° p√≠smena (a-z)</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="use_digits" name="use_digits" checked>
                    <label class="form-check-label" for="use_digits">Zahrnout ƒç√≠sla (0-9)</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="use_special" name="use_special">
                    <label class="form-check-label" for="use_special">Zahrnout speci√°ln√≠ znaky (r≈Øzn√© !@#$ apod...)</label>
                </div>
            </div>
        </div>

        <button type="submit" class="generate-password-submit">Generovat hesla</button>
    </form>

        {% if generated_passwords and not error_message %}
        <div id="generated-passwords-result" class="generated-password-box mt-4">
            <strong>Generovan√° hesla:</strong>

            <ul class="generated-password-list">
                {% for password in generated_passwords %}
                <li class="generated-password-item">
                    <code id="password-{{ forloop.counter }}">{{ password }}</code>

                    <button type="button"
                            class="copy-password-btn"
                            title="Zkop√≠rovat do schr√°nky"
                            onclick="copyPassword('password-{{ forloop.counter }}')">
                        üìã
                    </button>
                </li>
                {% endfor %}
            </ul>
        
                <div id="copy-feedback" class="copy-feedback">
                    Heslo zkop√≠rov√°no do schr√°nky
                </div>

        </div>
        {% endif %}
</div>


<script>
function copyPassword(elementId) {
    const el = document.getElementById(elementId);
    const feedback = document.getElementById("copy-feedback");

    if (!el || !feedback) return;

    navigator.clipboard.writeText(el.innerText).then(() => {
        feedback.classList.add("visible");

        setTimeout(() => {
            feedback.classList.remove("visible");
        }, 2000);
    });
}

document.addEventListener("DOMContentLoaded", () => {
    const result = document.getElementById("generated-passwords-result");
    if (result) {
        result.scrollIntoView({
            behavior: "smooth",
            block: "start"
        });
    }
});

</script>

{% endblock %}